<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
      
        XMonad Install on NetBSD 5.0 &middot; Perpetually Curious Blog
      
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="../css/poole.css">
  <link rel="stylesheet" href="../css/syntax.css">
  <link rel="stylesheet" href="../css/lanyon.css">
  <link rel="stylesheet" href="../css/book.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../images/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="../images/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="../atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-28532776-1', 'auto');
    ga('send', 'pageview');
  </script>
<!-- End Google Analytics -->
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">

  <div class="sidebar-item">
    <img src="../images/tim-movember-2009.jpg" />
    <p>Tim McGilchrist</p>
    <p>Software Engineer at Digital Asset in Sydney</p>

    <p>
      Twitter: <a href="https://twitter.com/lambda_foo">@lambda_foo</a><br>
      Github: <a href="https://github.com/tmcgilchrist">tmcgilchrist</a><br>
      Email: <a href="mailto:timmcgil@gmail.com">timmcgil@gmail.com</a><br>
      LinkedIn: <a href="https://www.linkedin.com/in/timmcgilchrist">Tim McGilchrist</a>
    </p>

  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="../">
      Blog
    </a>
    <a class="sidebar-nav-item" href="../about">
      About
    </a>
    <a class="sidebar-nav-item" href="../talks">
      Talks
    </a>
    <p class="sidebar-nav-item">
      Feed:
      <a href="../rss.xml">
        RSS
      </a>
      /
      <a href="../atom.xml">
        Atom
      </a>
    </p>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; Tim McGilchrist 2007-2021
    </p>
    <p>
      Powered by Hakyll
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="../" title="Home">Perpetually Curious Blog</a>
            
            <span class="masthead-links">
              <a href="../">Blog</a> |
              <a href="../pages/about.html">About</a> |
              <a href="../archive.html">Archive</a> |
              <a href="../pages/talks.html">Talks</a>
            </span>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">XMonad Install on NetBSD 5.0</h1>
  <span class="post-date">May 30, 2009</span>
  <p>I had some issues with getting XMonad and it’s dependencies working on NetBSD 5.0 with pkgsrc, so I thought I’d put this up to help out others and myself when I forget how it was done.</p>
<p>Start by installing ghc-6.8.3 from pkgsrc. The two options here are: * pkg_add -v ghc * cd /usr/pkgsrc/lang/ghc; make; make install</p>
<p>Both require root access. The first option will download a prebuilt binary of ghc and install it all for you. I chose the second option which involves downloading the <a href="http://www.netbsd.org/docs/pkgsrc/getting.html#getting-first">pkgsrc source</a> and <a href="http://www.netbsd.org/docs/pkgsrc/using.html#how-to-build-and-install">compiling from source</a>.</p>
<p>Next up you need to install Xmonad’s dependencies: * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/mtl">mtl</a> * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/unix">unix</a> * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/X11">X11</a></p>
<p>Running <strong>ghc-pkg list</strong> will show you what is already installed.</p>
<p>Mine looked something like this:</p>
<pre class="shell"><code>
micro# ghc-pkg list
/usr/pkg/lib/ghc-6.8.3/package.conf:
    Cabal-1.2.4.0, HUnit-1.2.0.0, QuickCheck-1.1.0.0, X11-1.4.5,
    array-0.1.0.0, base-3.0.2.0, bytestring-0.9.0.1.1, cgi-3001.1.6.0,
    containers-0.1.0.2, directory-1.0.0.1, fgl-5.4.2.0,
    filepath-1.1.0.0, (ghc-6.8.3), haskell-src-1.0.1.2,
    haskell98-1.0.1.0, hpc-0.5.0.1, html-1.0.1.1, mtl-1.1.0.1,
    network-2.2.0.0, old-locale-1.0.0.0, old-time-1.0.0.0,
    packedstring-0.1.0.0, parallel-1.0.0.1, parsec-2.1.0.1,
    pretty-1.0.0.0, process-1.0.0.1, random-1.0.0.0, readline-1.0.1.0,
    regex-base-0.72.0.1, regex-compat-0.71.0.1, regex-posix-0.72.0.2,
    rts-1.0, stm-2.1.1.1, template-haskell-2.2.0.0, time-1.1.2.1,
    unix-2.3.0.1, xhtml-3000.2.0.0</code></pre>
<p>So I only needed X11 which I grabbed from <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/X11">here</a>. Untar the X11 download, hop into that directory and run each of these commands in order.</p>
<pre><code>runhaskell Setup configure
runhaskell Setup build
runhaskell Setup install</code></pre>
<p>If it fails, <strong>good</strong> it’s just like my install. I got the following stack trace:</p>
<pre class="shell"><code>
Building X11-1.4.5...
[22 of 24] Compiling Graphics.X11.Xlib.Extras ( dist/build/Graphics/X11/Xlib/Extras.hs, dist/build/Graphics/X11/Xlib/Extras.o )
Warning: orphan instances:
  instance GHC.Read.Read [Graphics.X11.Xlib.Types.Rectangle]
    = Graphics.X11.Xlib.Extras.$f1

In file included from /usr/pkg/lib/ghc-6.8.3/include/Stg.h:183,
                 from /usr/pkg/lib/ghc-6.8.3/include/Rts.h:19,

                 from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:


/usr/pkg/lib/ghc-6.8.3/include/Regs.h:28:17:
     error: gmp.h: No such file or directory
In file included from /usr/pkg/lib/ghc-6.8.3/include/Stg.h:183,
                 from /usr/pkg/lib/ghc-6.8.3/include/Rts.h:19,

                 from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:


/usr/pkg/lib/ghc-6.8.3/include/Regs.h:121:0:
     error: expected specifier-qualifier-list before 'MP_INT'

In file included from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:


/usr/pkg/lib/ghc-6.8.3/include/Rts.h:203:0:
     error: expected ')' before '*' token

/usr/pkg/lib/ghc-6.8.3/include/Rts.h:204:0:
     error: expected ')' before '*' token
</code></pre>
<p>Seems that it’s actually complaining that it can’t see gmp.h. So the quick ’n nasty fix for this is.</p>
<pre><code>ln -s /usr/pkg/include/gmp.h /usr/pkg/lib/ghc-6.8.3/include/gmp.h</code></pre>
<p>Idea originally from <a href="http://ghcsparc.blogspot.com/2009/01/in-in-morning.html">here</a>.</p>
<p>Now retry, <strong>runhaskell Setup build</strong> and <strong>runhaskell Setup install</strong>, which should work now.</p>
<p>Next download the xmonad sources from <a href="http://xmonad.org">http://xmonad.org</a>, I grabbed both xmonad and xmonad-contrib. Untar them and follow the same runhaskell commands from before:</p>
<pre><code>runhaskell Setup configure
runhaskell Setup build
runhaskell Setup install</code></pre>
<p>It should now all compile &amp; install correctly, and <strong>you</strong> can get on with using Xmonad.</p>
<p>Finally here are some helpful Xmonad starter links:</p>
<ul>
<li><a href="http://xmonad.org/tour.html">http://xmonad.org/tour.html</a></li>
<li><a href="http://haskell.org/haskellwiki/Xmonad/Config_archive/John_Goerzen's_Configuration">http://haskell.org/haskellwiki/Xmonad/Config_archive/John_Goerzen’s_Configuration</a></li>
<li><a href="http://www.xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Doc-Configuring.html">http://www.xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Doc-Configuring.html</a></li>
</ul>
</div>


        <div class="container content">
          <small>Copyright © Tim McGilchrist 2007-2021</small>
          <br>
          <small>Powered by <a href="https://github.com/tmcgilchrist/lambdafoo.com">Hakyll</a></small>
        </div>
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
    </body>
</html>
