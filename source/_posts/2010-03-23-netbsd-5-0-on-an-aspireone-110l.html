--- 
layout: post
title: NetBSD 5.0 On An AspireOne 110L
tags: 
- NetBSD
status: publish
type: post
published: true
meta: 
  _edit_last: "1"
  _oembed_e58738786ab31c2223d8278a9329726a: "{{unknown}}"
  _oembed_2f0f2645bd16c09be09d742f8eec987b: "{{unknown}}"
---
After trying Ubuntu Linx on the AspireOne for a few months, I wanted to branch out and try something a bit different. Linux is so main stream theses days, I only had to mess around with the wireless. Far too easy. Why back in my day we entered our X11 config on punchcards!!!

Anyway, my options were either OpenBSD or NetBSD.

I've wanted to try OpenBSD on the desktop for ages, but being a bit fresh at the BSDs I decided to go for NetBSD. It was a bit less daunting and there are more online resources for NetBSD. But there is still something about OpenBSD, I'm sure I'll get around to it soon.

So I started off with downloading the ISO images for the latest <a href="http://www.netbsd.org/releases/formal-5/NetBSD-5.0.html">NetBSD</a> release 5.0. The latest release of NetBSD includes improved ACPI support and the ath(4) wireless is (apparently) supported. Plus all the other goodies mentioned in the release notes.

<!--more-->
<h2>NetBSD Install</h2>
<div>
<div>NetBSD has a basic terminal based installer, anyone with some Unix experience should be comfortable and even without any experience, just reading the <a href="http://www.netbsd.org/docs/guide/en/index.html">installer</a> guide should get you a working system.</div>
</div>
<div>My AspireOne 110L came with:</div>
<div>
<ul>
	<li> Intel Atom 270 (1.6Ghz)</li>
	<li>1.5Gb RAM (upgraded from the base 512MB)</li>
	<li>8Gb SSD, and</li>
	<li>8.9"screen @ 1024x600</li>
</ul>
</div>
No CD drive meant that I needed a bootable USB drive. I followed these<a href="http://wiki.netbsd.se/How_to_install_NetBSD_from_an_USB_Memory_Stick"> basic guidelines</a>.

Since this page was written for 4.0 some of the steps are different.

Step 7. change the url from
<pre>ftp -a ftp://ftp.netbsd.org/pub/NetBSD/iso/4.0.1/i386cd-4.0.1.iso</pre>
to
<pre>http://ftp.netbsd.org/pub/NetBSD/iso/5.0/i386cd-5.0.iso</pre>
<div>At Step 9 change it to look like this:</div>
<pre>
<div># mount /dev/sd0a /stick</div>
<div># cp /image/i386/binary/kernel/netbsd-FLOPPY.gz /stick/netbsd.gz</div>
<div># cp -R /image/i386/binary/sets /stick/sets</div>
<div># umount /stick</div>
<div># rmdir /stick</div></pre>
<div>

<span>I'm not sure I used the correct kernel here, the name suggests a bootable floppy kernel rather than the normal install kernel. I tried the netbsd-GENERIC.tgz but it started looking for things like "init" and "/etc/rc" which didn't seem right so I went back to the other kernel.</span>
<div>After I had the bootable USB setup correctly I rebooted the Aspire and started the install. Initially I tried following the instructions on installing from the "sets" copied onto the USB stick but the installer couldn't find them. So In the end I went for the HTTP install (<a href="http://www.netbsd.org/docs/guide/en/chap-exinst.html#inst-medium">Figure 3.20</a> from the Install Guide), a few hours later the installed finished. Rebooting the system brought this greeting:</div>
<pre>
<div>    Last login: Mon May 18 22:09:59 2009 from 172.17.0.10</div>
<div>    NetBSD 5.0 (GENERIC) #0: Sat May 16 18:00:22 EST 2009</div>
<div>    Welcome to NetBSD!</div>
<div>    micro$</div></pre>
<div>After poking around for a bit the 2 main outstanding issues are: X11 Setup and Wireless.</div>
<h2>X11 Setup</h2>
Here the NetBSD docs are really lacking, they still explain how to configure XFree86 which is a complete pain. Instead NetBSD is shipping with Xorg, providing a vastly superior configuration experience.

Simply run <strong>X -configure</strong> as root. Nice!

It'll dump an <strong>xorg.conf.new</strong> in root's home directory.

To test the server with this file, run <strong>X -config /root/xorg.conf.new</strong>

And if you're happy with it copy it over to /etc/X11/xorg.conf.
<h2>Wireless</h2>
The ath(4) driver doesn't attachg correctly with the default GENERIC kernel.

So apply this patch
<pre>ftp://ftp.netbsd.org/pub/NetBSD/misc/jmcneill/old/atheee.patch</pre>
Recompile the GENERIC kernel and reboot.

All the steps are documented here:

http://www.netbsd.org/docs/guide/en/chap-tuning.html#tuning-kernel-prepare

After a reboot it's recognised:
<pre>ath0 at pci3 dev 0 function 0
ath0: interrupting at ioapic0 pin 18
ath0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
ath0: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps</pre>
<h2>Things to fix up</h2>
<div>
<div>Install NetBSD and getting productive certainly isn't the seamless process that Ubuntu was. So there are a few minor things that need a bit of fixing.</div>
<div>
<ol>
	<li>Wireless on WPA2: Linux worked on this so I'm sure NetBSD can.</li>
	<li>Booting straight into X: It's in the docs so it won't be hard.</li>
	<li>Installing a decent WindowManager: XMonad here we come :-)</li>
</ol>
</div>
<h3>Resources:</h3>
<div><a href="http://wiki.netbsd.se/Acer_Aspire_one">http://wiki.netbsd.se/Acer_Aspire_one</a></div>
<div><a href="http://www.netbsd.org/docs/guide/en/">http://www.netbsd.org/docs/guide/en/</a></div>
<div><a href="http://mail-index.netbsd.org/current-users/2008/08/21/msg004079.html">http://mail-index.netbsd.org/current-users/2008/08/21/msg004079.html</a></div>
</div>
</div>
