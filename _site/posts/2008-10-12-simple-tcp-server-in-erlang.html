<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>My Hakyll Blog - Simple TCP Server in Erlang</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/screen.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">My Hakyll Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../talks.html">Talks</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Simple TCP Server in Erlang</h1>

            <div class="info">
    Posted on October 12, 2008
    
</div>

<p>Just a quick example of a tcp server that returns the current time.</p>
<p>{% codeblock lang:erlang %} -module(daytime). -export([start/0]).</p>
<p>start() -&gt; {ok, Listen} = gen_tcp:listen(1313, [binary, {packet, 0}, {active, false}, {reuseaddr, true}]), spawn(fun() -&gt; connect(Listen) end).</p>
<p>connect(Listen) -&gt; {ok, Socket} = gen_tcp:accept(Listen), spawn(fun() -&gt; connect(Listen) end), gen_tcp:send(Socket, getDateTime()), gen_tcp:close(Socket).</p>
<p>getDateTime() -&gt; {YearMonthDay, {Hour, Minute, Second}} = calendar:universal_time_to_local_time(erlang:universaltime()), DayOfWeek = calendar:day_of_the_week(YearMonthDay), DayName = httpd_util:day(DayOfWeek), MonthName = httpd_util:month(Month), DateString = io_lib:format(“~s, ~s ~p, ~p <sub>p:</sub>p:<sub>p</sub>n”, [DayName, MonthName, Day, Year, Hour, Minute, Second]), lists:flatten(DateString).</p>
<p>{% endcodeblock %}</p>
<p>To test, startup an erlang shell:</p>
<pre><code>erl</code></pre>
<p>Compile the daytime.erl file:</p>
<pre><code>1&gt; c(daytime).
{ok,daytime}</code></pre>
<p>Startup the daytime server:</p>
<pre><code>2&gt; daytime:start().
&lt;0.50.0&gt;</code></pre>
<p>Now in another terminal fire up telnet and connect to port 1313.</p>
<pre><code>telnet localhost 1313</code></pre>
<p>You should get something like this:</p>
<pre><code>Trying ::1...
telnet: connect to address ::1: Connection refused
Trying fe80::1...
telnet: connect to address fe80::1: Connection refused
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
Sun, Oct 12, 2008 11:33:26
Connection closed by foreign host.</code></pre>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
