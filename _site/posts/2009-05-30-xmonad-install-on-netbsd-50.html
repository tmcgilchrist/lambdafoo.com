<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>My Hakyll Blog - XMonad Install on NetBSD 5.0</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/screen.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">My Hakyll Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../talks.html">Talks</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>XMonad Install on NetBSD 5.0</h1>

            <div class="info">
    Posted on May 30, 2009
    
</div>

<p>I had some issues with getting XMonad and it’s dependencies working on NetBSD 5.0 with pkgsrc, so I thought I’d put this up to help out others and myself when I forget how it was done.</p>
<p>Start by installing ghc-6.8.3 from pkgsrc. The two options here are: * pkg_add -v ghc * cd /usr/pkgsrc/lang/ghc; make; make install</p>
<p>Both require root access. The first option will download a prebuilt binary of ghc and install it all for you. I chose the second option which involves downloading the <a href="http://www.netbsd.org/docs/pkgsrc/getting.html#getting-first">pkgsrc source</a> and <a href="http://www.netbsd.org/docs/pkgsrc/using.html#how-to-build-and-install">compiling from source</a>.</p>
<p>Next up you need to install Xmonad’s dependencies: * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/mtl">mtl</a> * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/unix">unix</a> * <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/X11">X11</a></p>
<p>Running <strong>ghc-pkg list</strong> will show you what is already installed.</p>
<p>Mine looked something like this:</p>
<p>{% codeblock lang:bash %}</p>
<p>micro# ghc-pkg list /usr/pkg/lib/ghc-6.8.3/package.conf: Cabal-1.2.4.0, HUnit-1.2.0.0, QuickCheck-1.1.0.0, X11-1.4.5, array-0.1.0.0, base-3.0.2.0, bytestring-0.9.0.1.1, cgi-3001.1.6.0, containers-0.1.0.2, directory-1.0.0.1, fgl-5.4.2.0, filepath-1.1.0.0, (ghc-6.8.3), haskell-src-1.0.1.2, haskell98-1.0.1.0, hpc-0.5.0.1, html-1.0.1.1, mtl-1.1.0.1, network-2.2.0.0, old-locale-1.0.0.0, old-time-1.0.0.0, packedstring-0.1.0.0, parallel-1.0.0.1, parsec-2.1.0.1, pretty-1.0.0.0, process-1.0.0.1, random-1.0.0.0, readline-1.0.1.0, regex-base-0.72.0.1, regex-compat-0.71.0.1, regex-posix-0.72.0.2, rts-1.0, stm-2.1.1.1, template-haskell-2.2.0.0, time-1.1.2.1, unix-2.3.0.1, xhtml-3000.2.0.0 {% endcodeblock %}</p>
<p>So I only needed X11 which I grabbed from <a href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/X11">here</a>. Untar the X11 download, hop into that directory and run each of these commands in order.</p>
<pre><code>runhaskell Setup configure
runhaskell Setup build
runhaskell Setup install</code></pre>
<p>If it fails, <strong>good</strong> it’s just like my install. I got the following stack trace:</p>
<p>{% codeblock lang:bash %}</p>
<p>Building X11-1.4.5… [22 of 24] Compiling Graphics.X11.Xlib.Extras ( dist/build/Graphics/X11/Xlib/Extras.hs, dist/build/Graphics/X11/Xlib/Extras.o ) Warning: orphan instances: instance GHC.Read.Read [Graphics.X11.Xlib.Types.Rectangle] = Graphics.X11.Xlib.Extras.$f1</p>
<p>In file included from /usr/pkg/lib/ghc-6.8.3/include/Stg.h:183, from /usr/pkg/lib/ghc-6.8.3/include/Rts.h:19,</p>
<pre><code>             from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:</code></pre>
<p>/usr/pkg/lib/ghc-6.8.3/include/Regs.h:28:17: error: gmp.h: No such file or directory In file included from /usr/pkg/lib/ghc-6.8.3/include/Stg.h:183, from /usr/pkg/lib/ghc-6.8.3/include/Rts.h:19,</p>
<pre><code>             from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:</code></pre>
<p>/usr/pkg/lib/ghc-6.8.3/include/Regs.h:121:0: error: expected specifier-qualifier-list before ‘MP_INT’</p>
<p>In file included from dist/build/Graphics/X11/Xlib/Extras_stub.c:2:0:</p>
<p>/usr/pkg/lib/ghc-6.8.3/include/Rts.h:203:0: error: expected ‘)’ before ’*’ token</p>
<p>/usr/pkg/lib/ghc-6.8.3/include/Rts.h:204:0: error: expected ‘)’ before ’*’ token</p>
<p>{% endcodeblock %}</p>
<p>Seems that it’s actually complaining that it can’t see gmp.h. So the quick ’n nasty fix for this is.</p>
<pre><code>ln -s /usr/pkg/include/gmp.h /usr/pkg/lib/ghc-6.8.3/include/gmp.h</code></pre>
<p>Idea originally from <a href="http://ghcsparc.blogspot.com/2009/01/in-in-morning.html">here</a>.</p>
<p>Now retry, <strong>runhaskell Setup build</strong> and <strong>runhaskell Setup install</strong>, which should work now.</p>
<p>Next download the xmonad sources from <a href="http://xmonad.org">http://xmonad.org</a>, I grabbed both xmonad and xmonad-contrib. Untar them and follow the same runhaskell commands from before:</p>
<pre><code>runhaskell Setup configure
runhaskell Setup build
runhaskell Setup install</code></pre>
<p>It should now all compile &amp; install correctly, and <strong>you</strong> can get on with using Xmonad.</p>
<p>Finally here are some helpful Xmonad starter links:</p>
<ul>
<li><a href="http://xmonad.org/tour.html">http://xmonad.org/tour.html</a></li>
<li><a href="http://haskell.org/haskellwiki/Xmonad/Config_archive/John_Goerzen's_Configuration">http://haskell.org/haskellwiki/Xmonad/Config_archive/John_Goerzen’s_Configuration</a></li>
<li><a href="http://www.xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Doc-Configuring.html">http://www.xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Doc-Configuring.html</a></li>
</ul>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
